#include "nfc_driver.h"
#include "print_driver.h"

int main()
{
	Printer p(true);
	NfcDevice   nfc(&p);
	Card		*tmp;

	tmp = nfc.findCard();
	Card	card = *tmp;
	size_t	i = 0;
	const static uint8_t	key[] = 
	{
		0xd3, 0xf7, 0xd3, 0xf7, 0xd3, 0xf7,
		0xa0, 0xa1, 0xa2, 0xa3, 0xa4, 0xa5,
		0xb0, 0xb1, 0xb2, 0xb3, 0xb4, 0xb5,
		0x4d, 0x3a, 0x99, 0xc3, 0x51, 0xdd,
		0x1a, 0x98, 0x2c, 0x7e, 0x45, 0x9a,
		0xaa, 0xbb, 0xcc, 0xdd, 0xee, 0xff,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0xab, 0xcd, 0xed, 0x12, 0x34, 0x56,
	};
	while (!card.readSector(1))
	{
		card[1].setAuthentificationKey(&key[i]);
		i+= 6;
		if (i > 7 * 6)
		{
			p.printError("Erreur lors de l'authentification");
			break;
		}
	}
	return 0;
}
